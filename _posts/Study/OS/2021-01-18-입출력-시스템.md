---
layout: post
title: "입출력 시스템"
categories:
  - Study
  - OS
tags:
  - OS
created_at: 2021-01-18T17:35:00+09:00
modified_at: 2021-01-18T17:35:00+09:00
visible: true
---

## 입출력 시스템이란?

> 컴퓨터 외부에서 발생하는 데이터를 CPU나 메모리로 읽어들이거나(입력), 내부의 데이터를 외부로 출력하는 시스템

* 프로세스 실행 과정에서 필요한 데이터를 입력 받거나, 혹은 발생한 데이터를 외부로 출력하는 시스템을 의미한다.
* 입출력장치 - 장치 제어기 - 입출력 인터페이스 - CPU - 메모리로 이루어져 있다.
* 입출력장치와 CPU, 메모리의 입출력 속도 차이가 존재하기 때문에 적절한 입출력 방식의 사용이 필요하다.
* 메모리까지 데이터를 적재하거나 혹은 메모리로부터 데이터를 출력하는 과정에 따라 직접 입출력과 간접 입출력으로 나뉜다.



### 직접 입출력

* 입출력 데이터가 CPU를 거쳐 메모리에 적재, 출력되는 방식을 직접 입출력이라고 한다.

* 직접 입출력은 폴링 방식과 인터럽트 방식이 존재한다

#### 폴링(polling) 방식

* 프로세스에서 입출력 요청이 발생한 경우 **장치 구동기**에 신호를 보내 연산을 요청한다.
* 장치 구동기는 **장치 제어기**의 상태 레지스터를 확인해 입출력 장치를 사용 가능한지 확인한다.
* 장치가 사용 가능한 경우 입출력 연산을 실행한다.
* CPU는 입출력 연산이 종료되었는지 확인하기 위해 주기적으로 장치 제어기의 상태 레지스터를 확인(polling)한다.
* 입출력 연산이 종료된 경우 프로세스를 이어서 진행한다.
* 폴링 방식의 경우 CPU가 지속적으로 장치 제어기의 상태 레지스터를 확인해야 한다는 점에서 CPU 사용이 비효율적이라는 단점이 존재한다.

#### 인터럽트(interrupt) 방식

* CPU는 **장치 구동기**에 입출력 연산을 요청 한 후 해당 프로세스를 대기(Waiting)상태로 바꾸고 다른 프로세스를 수행한다.
* 장치 구동기는 **장치 제어기**의 상태 레지스터를 확인해 입출력 장치를 사용 가능한지 확인한다.
* 장치가 사용 가능 한 경우 **장치 상태 테이블**에 정보를 기록하고 입출력 연산을 수행한다.
* 입출력 장치의 연산이 완료 된 후 입출력 장치의 **장치 제어기**에서 인터럽트를 발생시킨다.
* 인터럽트 처리기는 **장치 상태 테이블**을 확인해 알맞은 프로세스를 깨워 실행시키도록 한다. 



### 간접 입출력

* 입출력 데이터가 CPU를 **거치치 않고** 메모리에 적재, 출력되는 방식을 간접 입출력이라고 한다.

* CPU를 다수의 프로세스가 공유하여 사용하기 때문에 CPU 사용 효율을 향상 시키기 위해 DMA나 입출력 전담 프로세서인 I/O 채널을 사용해 입출력 과정을 위임한다.

#### DMA(Direct Memory Access)

* CPU의 개입 없이 입출력 장치와 메모리간의 데이터 직접 교환이 가능하도록 하는것
* 직접 입출력의 인터럽트 방식으로 데이터를 전송한다고 하더라도 다수의 프로세스에서 입출력이 수행 될 때마다 인터럽트가 계속 발생하기 때문에 CPU 효율이 저하된다.
* CPU는 DMA 제어기에게 입출력을 맡기고 상태와 제어 정보만을 주고 받으므로써 CPU의 효율을 향상시킨다.
* 입출력 요청이 발생한 경우 CPU는 DMA 제어기로 요청이 온 입출력 장치, 연산, 입출력 하기 위한 메모리 주소 등을 전달한다.
* DMA 제어기는 메모리 버스의 사용 권한을 CPU에 요청하고 CPU는 승인한다.(Cycle Steal)
* DMA 제어기는 입출력 장치와 메모리 사이의 데이터 전송을 수행하고 CPU는 메모리에 접근 할 필요가 없는 다른 연산(명령어 해독 등)을 수행한다.

#### I/O Channel

* 입출력만을 전담하는 I/O Channel에 의해 입출력 연산이 처리된다.
* DMA 방식의 경우 CPU의 제어가 필요하지만 I/O Channel의 경우 입출력을 완전히 전담하는 프로세서이기 때문에 CPU와 인터럽트로 정보를 전달할 뿐 완전히 독립적으로 동작한다.



## 인터럽트

> 입출력 처리나 예외 처리 등으로 현재 수행중인 프로세스를 잠시 중단하고 즉시 수행해야 하는 긴급한 작업 또는 작업이 필요함을 요청하는 행위

* 다중 프로그래밍 환경에서 하나의 프로세서를 다수의 프로세스가 공유해서 사용하기 때문에 프로세스는 일반적으로 프로세스 스케쥴링에 의한 순서대로 처리된다.
* 하지만 입출력 요청과 같은 처리가 긴급한 요청이 발생할 경우 현재 수행되는 프로세스를 잠시 중단하고 긴급한 요청을 먼저 처리해야되는 경우가 발생한다.
* 이럴 경우 인터럽트를 발생시켜 긴급한 요청을 수행한 뒤 중단한 프로세스를 이어서 처리하는 과정을 거친다.



### 인터럽트 과정

1. 프로세서가 프로세스를 수행하는 도중에 인터럽트가 발생
2. 현재 수행중인 프로세스의 진행정보를 PCB에 저장하고 프로세스를 중단한다.
3. 발생한 인터럽트의 **인터럽트 서비스 루틴**으로 이동하여 작업을 수행한다.
4. 인터럽트 서비스 루틴의 수행이 완료되면 중단된 프로세스의 PCB를 불러와 이어서 수행한다.



### 인터럽트 종류

* 인터럽트의 발생위치와 이유에 따라서 분류한다.
* 우선순위는 다음과 같으며 높은 우선순위가 가장 먼저 수행된다.

#### 외부 인터럽트

> 프로세스 외부에서 발생하는 인터럽트

1. 전원 이상 인터럽트
   * 전원 공급의 이상이 발생할 경우
2. 기계 이상 인터럽트
   * 컴퓨터 장치 자체의 이상이 발생했을 경우
3. 외부 신호 인터럽트
   * 프로세서 할당시간이 종료되어 발생되는 인터럽트
   * 사용자가 재시작 버튼을 누르거나 Ctrl + Alt +Delete 등 인위적인 인터럽트를 발생시키는 경우
4. 입출력 인터럽트
   * 키보드, 마우스 등의 입출력 장치에서 요청이 들어올때 발생하는 인터럽트

#### 내부 인터럽트(소프트웨어 인터럽트)

> 프로세스 내부에서 발생하는 인터럽트

5. 프로그램 검사 인터럽트
   * 0으로 나누기, 잘못된 명령어 사용, 잘못된 주소 참조, Overflow, Underflow 등이 발생하는 경우
   * 트랩이라고도 한다.
6. 슈퍼바이저 호출 인터럽트
   * 운영체제 슈퍼바이저에게 프로세스 제어를 넘겨주기 위해 의도적으로 발생시키는 인터럽트

