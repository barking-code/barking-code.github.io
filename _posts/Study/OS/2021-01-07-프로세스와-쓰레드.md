---
layout: post
title: "프로세스와 쓰레드"
categories:
  - Study
  - OS
tags:
  - OS
created_at: 2021-01-07T22:45:00+09:00
modified_at: 2021-01-08T18:05:00+09:00
visible: true
---

## 프로세스

> 프로세스란 현재 프로세서(CPU 혹은 Core)가 수행하고 있는 프로그램의 작업 단위이다.

프로그램은 명령어와 데이터의 덩어리로 사용되지 않을 때는 보조기억장치에 저장되어 있다. 프로그램을 실행하게 되면 주기억장치(Memory)에 프로그램(코드의 일부)이 load되는데 이를 process라고 한다.

1개의 프로세서는 1개의 프로세스를 수행하게 되는데 운영체제위에서 수많은 프로세스들이 실행되기때문에 프로세스들에게 자원을 균일하게 분배하여 마치 동시에 동작하는 것(멀티태스킹)처럼 보인다.



### 프로세스의 상태와 동작

![image-20210107231449248](post_img/2021-01-07-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4%EC%99%80-%EC%93%B0%EB%A0%88%EB%93%9C/image-20210107231449248.png)

#### 프로세스 상태

1. New
   * 프로그램이 메모리에 load되어 프로세스가 생성 된 상태
2. Ready
   * 프로세스가 프로세서를 할당받아 실행되기위해 대기중인 상태
3. Running
   * 프로세스가 실행되고 있는 상태
4. Waiting
   * 프로세스가 입출력등의 이벤트가 발생하면 자원을 일시적으로 반납하고 대기중인 상태
   * 입출력의 경우 프로세서 동작속도에 비해 매우 느리기 때문에 동작이 끝날때까지 프로세서가 대기하는 시간이 발생하게 됨.
   * 이를 줄이고자 시간이 오래 걸리는 이벤트가 발생시 자원을 반납하고 대기 큐에 대기하고 있다가 이벤트가 완료되면 발생되는 인터럽트에 의해 대기 큐에서 나와 나머지 작업을 이어서 수행
5. Terminatd
   * 프로세스가 완전히 종료되어 제거된 상태



#### 프로세스 동작

1. Dispatch
   * Ready중인 프로세스들 중 우선순위가 가장 높은 프로세스에 프로세서를 할당한다.
2. Timer Runout
   * 지정된 할당시간이 종료되면 프로세스는 할당받은 자원을 반납하고 Ready 상태로 돌아간다.
3. Block
   * 입출력 등 시간이 걸리는 이벤트 발생시 자원을 일시적으로 반납하고 Waiting 상태로 바뀐다.
4. Wake up
   * 이벤트 처리가 완료된 프로세스를 Ready 상태로 바꾼다.



### 프로세스 제어 블록(Process Control Block, PCB)

> 프로세스에 대한 정보가 담겨있는 자료구조이다.
>
> 모든 프로세스는 PCB를 가지고 종료되면 PCB도 소멸된다.

1. PID(Process Identifier)
   * 프로세스를 내부적으로 식별 할 수 있는 ID

2. 프로세스 문맥(Process Context)
   * 프로세스가 실행되는 정보
   * 프로세스 중단(Timer Runout)시 프로세스 진행에 대한 정보를 가지고 있다가 실행(Running)시 이어서 실행하기 위해 필요하다
3. 할당 메모리 주소
   * 프로세스에 할당된 메모리의 주소 포인터 값
4. 프로세스 우선 순위
   * 프로세스 우선 순위가 높은 순서대로 프로세서를 할당받는다.
5. 프로세스 상태
   * 현재 프로세스의 상태
6. 프로세스 권한
   * 프로세스가 접근할 수 있는 자원의 범위를 결정한다.



### Context Switching

> 프로세서가 현재 수행중인 프로세스를 다른 프로세스로 바꾸는 과정

하나의 프로세서가 동시에 여러 프로세스를 진행하는 것처럼 **보이기**위해서 빠른속도로 현재 실행중인 프로세스를 교체하며 실행한다. 이때 프로세스가 자원을 할당받으면 중단된 시점부터 연속으로 프로세스를 진행하기 위해 프로세스 정보를 PCB에 저장해둔다.

Context Switching이란 현재 진행중인 프로세스를 중단하고 자원을 할당할 프로세스의 PCB에서 정보를 읽어오는 과정을 말한다. Context Switching이 일어나는 시간동안 프로세스는 프로세스를 수행 할 수 없으므로 가능한 Context Switching시간을 줄이는 것이 중요하다.

프로세스에 할당되는 단위 시간을 Quantum 또는 Time Slice라고 하는데 이 단위 시간이 길수록 Context Switching은 적게 일어나지만 프로세스의  프로세서 선점 시간이 늘어나게되고, 단위 시간이 짧을수록 프로세서 선점 시간은 짧아지지만 Context Switching이 많이 일어나게 된다.

#### Context Switching이 발생하는 경우

1. 프로세서 할당시간이 만료되었을 때(Timer Runout)
2. I/O 이벤트 발생 시
3. 기타 인터럽트 발생 시

---

## 쓰레드

> 프로세스 내에서 명령어에 의해 수행되는 작업의 단위

프로세스가 1개의 프로세서를 할당받아 프로그램을 실행한다면, 쓰레드는 프로세스 내에서 프로세스가 할당받은 자원을 사용해 1개의 작업을 수행한다고 할 수 있다. 따라서 어떤 **프로세스가 존재**한다면 어떤 **작업을 수행**한다는 뜻이고 어떤 **작업이 수행**된다는 이야기는 **쓰레드가 존재**한다는 이야기이다.

즉, 프로세스 내에는 반드시 1개의 쓰레드가 존재하고 멀티 쓰레드 프로그램을 작성한다면 다수의 쓰레드가 존재 할 수도 있다. 쓰레드는 프로세스가 할당받은 자원을 공유하여 사용한다.

---

## 프로세스 메모리 구조



---

## 프로세스 스케쥴링